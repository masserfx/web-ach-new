â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          Browser MCP Connection - Quick Reference Card                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ PROBLÃ‰M: Extension na Macu se neconnectuje na 91.99.126.53:8765

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš¡ TEST 1: Network Connectivity (Mac Terminal)

    nc -zv 91.99.126.53 8765

    âœ… Expected: "Connection successful"
    âŒ If: "refused" or "timeout" â†’ FIREWALL ISSUE â†’ Use SSH Tunnel
    âœ… If success â†’ Continue to Test 2

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš¡ TEST 2: WebSocket Handshake (Mac Terminal)

    curl -i -N \
      -H "Connection: Upgrade" \
      -H "Upgrade: websocket" \
      -H "Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==" \
      -H "Sec-WebSocket-Version: 13" \
      http://91.99.126.53:8765/

    âœ… Expected: "HTTP/1.1 101 Switching Protocols" (in first line)
    âŒ If: "404" or "500" â†’ SERVER CONFIG ISSUE â†’ Restart daemon
    â±ï¸ If: timeout after 3s â†’ FIREWALL ISSUE â†’ Use SSH Tunnel
    âœ… If 101 â†’ Continue to Test 3

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš¡ TEST 3: Extension Permissions (Chrome DevTools)

    1. Chrome: chrome://extensions
    2. Browser MCP: "Inspect views" â†’ "background page"
    3. Console tab â†’ paste this:

    chrome.runtime.getManifest((manifest) => {
      const perms = manifest.host_permissions || [];
      const has91 = perms.some(p => p.includes('91.99.126.53'));
      console.log('âœ… 91.99.126.53 allowed:', has91);
    });

    âœ… Expected: "âœ… 91.99.126.53 allowed: true"
    âŒ If: "false" â†’ MANIFEST ISSUE â†’ Update host_permissions
    âœ… If true â†’ Everything OK, try Reconnect!

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ”§ SOLUTION #1: FIREWALL (Test 1 or 2 failed)

    Step 1: Mac Terminal - Create SSH tunnel (leave running)
        ssh -i ~/.ssh/hetzner_server_ed25519 -N -L 8765:localhost:8765 leos@91.99.126.53

    Step 2: Chrome Extension Settings
        Host: 127.0.0.1  (was: 91.99.126.53)
        Port: 8765       (same)
        URL:  ws://127.0.0.1:8765

    Step 3: Click "Reconnect" button

    âœ… Should work now!

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ”§ SOLUTION #2: SERVER CONFIG (Test 2 returns 404/500)

    On Remote Server (SSH):
        ssh -i ~/.ssh/hetzner_server_ed25519 leos@91.99.126.53

        # Check daemon status
        ps aux | grep browsermcp | grep -v grep

        # Kill old daemon
        kill -9 <PID_FROM_ABOVE>

        # Restart daemon
        cd ~/.local/lib/browsermcp-enhanced
        npm start

        # Verify it's listening
        lsof -i :8765

    Back on Mac: Click "Reconnect"

    âœ… Should work now!

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ”§ SOLUTION #3: MANIFEST (Test 3 returns false)

    Step 1: Mac - Find extension directory
        ~/browsermcp-extension  (or find via Chrome devtools)

    Step 2: Edit manifest.json - add/update "host_permissions":

        "host_permissions": [
          "http://localhost:*/*",
          "ws://localhost:*/*",
          "http://127.0.0.1:*/*",
          "ws://127.0.0.1:*/*",
          "http://91.99.126.53:*/*",
          "ws://91.99.126.53:*/*"
        ]

    Step 3: Chrome: chrome://extensions â†’ Browser MCP â†’ Click ğŸ”„ Reload

    Step 4: Re-test with Test 3 code above

    Step 5: Click "Reconnect" button

    âœ… Should work now!

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“‹ DECISION TREE

    Does Test 1 (nc) succeed?
    â”œâ”€ NO â†’ Use Solution #1 (SSH Tunnel)
    â””â”€ YES
       â””â”€ Does Test 2 (curl) return 101?
          â”œâ”€ NO â†’ Use Solution #2 (Restart Daemon)
          â””â”€ YES
             â””â”€ Does Test 3 (manifest) return true?
                â”œâ”€ NO â†’ Use Solution #3 (Update Manifest)
                â””â”€ YES â†’ Click Reconnect, should work!

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“‚ FULL DIAGNOSTIC FILES

    - BROWSER_MCP_TROUBLESHOOT.md  â† Step-by-step solutions
    - BROWSER_MCP_CONNECTION_FIX.md â† Detailed analysis
    - BROWSER_MCP_REMOTE_DIAGNOSTICS.sh â† Server diagnostics

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… WHEN IT WORKS, YOU'LL SEE:

    1. Extension icon shows "Connected" status
    2. Chrome DevTools Network: WebSocket with "101" status
    3. Admin panel (91.99.126.53:3100): Browser MCP shows "running"
    4. Extension console: No CORS or timeout errors

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ’¡ KEY INSIGHTS

    â€¢ If firewall blocks: ssh tunnel makes it look like local connection
    â€¢ If server not responding: daemon needs restart
    â€¢ If browser complains: manifest permissions must match exactly
    â€¢ All 3 tests passing = solution exists and configuration is OK

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
